# Lab rules: Nmap scan and probe detection
# SIDs are in local range for educational use.

alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Nmap TCP SYN scan";
    flow:stateless;
    flags:S;
    detection_filter:track by_src, count 20, seconds 3;
    classtype:attempted-recon;
    sid:1000001;
    rev:1;
)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Nmap FIN scan";
    flow:stateless;
    flags:F;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon;
    sid:1000002;
    rev:1;
)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Nmap NULL scan";
    flow:stateless;
    flags:0;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon;
    sid:1000003;
    rev:1;
)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Nmap XMAS scan";
    flow:stateless;
    flags:FPU;
    detection_filter:track by_src, count 10, seconds 5;
    classtype:attempted-recon;
    sid:1000004;
    rev:1;
)

alert udp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Nmap UDP scan burst";
    flow:stateless;
    detection_filter:track by_src, count 25, seconds 5;
    classtype:attempted-recon;
    sid:1000005;
    rev:1;
)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB Suspicious ECN-like probe (possible OS fingerprinting)";
    flow:stateless;
    flags:SEC;
    classtype:attempted-recon;
    sid:1000006;
    rev:1;
)

alert icmp $EXTERNAL_NET any -> $HOME_NET any (
    msg:"LAB ICMP echo sweep burst";
    itype:8;
    detection_filter:track by_src, count 15, seconds 3;
    classtype:attempted-recon;
    sid:1000007;
    rev:1;
)
